head(MC_Ed)
MC_Ed %>% # filter(50:75) %>%
ggplot(x=wv,y=75) + geom_line()
MC_Ed %>% # filter(50:75) %>%
ggplot(aes(x=wv,y=75)) + geom_line()
MC_Ed %>% # filter(50:75) %>%
ggplot(aes(x=wv,y='75')) + geom_line()
MC_Ed %>% # filter(50:75) %>%
ggplot(aes(x=wv,y=`75`)) + geom_line()
MC_Ed %>% # filter(50:75) %>%
ggplot(aes(x=wv,y=`50`:`75`)) + geom_line()
help(gather)
MC_Ed %>% gather(key="depth",value="irrad",-'wv')
MC_Ed %>% gather(key="depth",value="irrad",-'wv')
head(MC_Ed)
MC_Ed %>% gather(key="depth",value="irrad",-'wv') -> MC_Ed
head(MC_Ed)
#seq1 <- seq(from=0,to=75,by=5)
MC_Ed <- read_delim('MC_Ed_R1F1.txt',delim=',')#,# col_names = c('wv',seq1),skip=1)
colnames(MC_Ed)[1] <- 'wv'
MC_Ed %>% gather(key="depth",value="irrad",-'wv') -> MC_Ed
head(MC_Ed)
MC_Ed %>% group_by(depth) %>%
ggplot(aes(x=wv,y='irrad')) + geom_line()
MC_Ed %>% group_by(depth) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
help(select)
MC_Ed %>% group_by(depth) %>%
select(ends_with(0)) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
select(ends_with('0')) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
#select(ends_with('0')) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
filter(ends_with('0')) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
help(filter)
help(select)
MC_Ed %>% group_by(depth) %>%
filter(ends_with(depth,'0')) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
help(filter)
MC_Ed %>% group_by(depth) %>%
filter(depth==*0) %>%
MC_Ed %>% group_by(depth) %>%
filter(is.integer(depth/2)) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
is.integer(34)
is.integer(32)
is.integer(32.1)
mod(2.3)
modulus(2.3)
modulus(2.3)
x%%2
x = 3.4
x%%2
x=23/2
x
x%%2
x=22/2
x%%2
x/2%%2
(x/2)%%2
MC_Ed %>% group_by(depth) %>%
filter((depth/2)%%2==1) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
depth = seq1
depth
(depth/2)%%2
depth
60 %% 2
70 %% 2
MC_Ed %>% group_by(depth) %>%
filter(depth%%2==1) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
filter(depth[depth%%2==1]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
depth[depth%%2==1]
MC_Ed %>% group_by(depth) %>%
filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
depth%%2==0
depth%%2
MC_Ed %>% group_by(depth) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
filter(depth %in% 50:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_line()
MC_Ed %>% group_by(depth) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_smooth()
MC_Ed %>% group_by(depth) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_point()
MC_Ed %>% group_by(depth) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point()
MC_Ed %>% group_by(depth) %>%
filter(wv < 700) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point()
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point()
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() + geom_smooth()
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 65:75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point()
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() + geom_smooth()
help("loess")
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.5)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.9)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.4)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.2)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.15)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
MC_Ed %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
help("geom_smooth")
MC_Ed$depth
help("mutate")
MC_Ed %>% rowwise()
MC_Ed
#seq1 <- seq(from=0,to=75,by=5)
MC_Ed <- read_delim('MC_Ed_R1F1.txt',delim=',')#,# col_names = c('wv',seq1),skip=1)
colnames(MC_Ed)[1] <- 'wv'
head(MC_Ed)
MC_Ed$75
MC_Ed$`75`
MC_Ed$`75` / MC_Ed$`50`
( MC_Ed$`75` / MC_Ed$`50` ) * MC_Ed$`75`
MC_Ed$`75`
#seq1 <- seq(from=0,to=75,by=5)
MC_Ed <- read_delim('MC_Ed_R1F1.txt',delim=',')#,# col_names = c('wv',seq1),skip=1)
colnames(MC_Ed)[1] <- 'wv'
MC_Ed$`100` <- ( MC_Ed$`75` / MC_Ed$`50` ) * MC_Ed$`75`
head(MC_Ed)
MC_Ed$`75` / MC_Ed$`50`
mean(MC_Ed$`75` / MC_Ed$`50`)
median(MC_Ed$`75` / MC_Ed$`50`)
summary(MC_Ed$`75` / MC_Ed$`50`)
MC_Ed %>% gather(key="depth",value="irrad",-'wv') -> mced
head(mced)
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 75) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 100) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,25,50,75)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,25,50,75)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,5,10,25,50,75)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,05,10,25,50,75)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=depth)) + geom_point()
MC_Ed %>% gather(key="depth",value="irrad",-'wv') -> mced
mced$depth <- as.numeric(mced$depth)
head(mced)
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,5,10,25,50,75)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,5,10,25,50,75)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(0,5,10,25,50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
max(mced$wv)
mced %>% group_by(depth) %>%
filter(wv < 700) %>%
filter(depth %in% c(0,5,10,25,50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
#filter(wv < 700) %>%
filter(depth %in% c(0,5,10,25,50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
#filter(wv < 700) %>%
filter(depth %in% c(0,5,10,25,50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_line()
mced %>% group_by(depth) %>%
#filter(wv < 700) %>%
filter(depth %in% c(0,5,10,25,50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% c(75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
help(filter)
mced %>% group_by(depth) %>%
filter(between(wv,400,700)) %>%
filter(depth %in% c(50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(between(wv,400,600)) %>%
filter(depth %in% c(50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(between(wv,350,600)) %>%
filter(depth %in% c(50,75,100)) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=-depth)) + geom_point()
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 100) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad,color=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
avogadro = 6.02214076*10^23
mced %>%
mutate(quanta = irrad / 1000 * avogadro) -> mced
mced
avogadro = 6.02214076*10^23
mced %>%
mutate(quanta = (irrad / 1000) * avogadro) -> mced
mced
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 100) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=irrad)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
avogadro = 6.02214076*10^23
mced %>%
mutate(quanta = (irrad / 1000) * avogadro) -> mced
mced %>% group_by(depth) %>%
filter(wv < 600) %>%
filter(depth %in% 100) %>%
# filter(depth[depth%%2==0]) %>%
ggplot(aes(x=wv,y=quanta)) + geom_point() +
geom_smooth(method = "loess", span=0.1)
MC_Ed$wv
MC_Ed[ , diff := value - shift(value)]
MC_Ed %>%
mutate(Diff = wv - lag(wv))
MC_Ed %>%
mutate(Diff = wv - lag(wv)) -> diffz
diffz
diffz$Diff
min(MC_Ed$wv)
max(MC_Ed$wv)
avogadro = 6.02214076*10^23
MC_Ed %>% gather(key="depth",value="irrad",-'wv') %>%
mutate(quanta = (irrad / 1000) * avogadro) -> mced
mced$depth <- as.numeric(mced$depth)
head(mced)
mced$irrad[mced$depth==100]
min(mced$irrad[mced$depth==100])
mced %>%
filter(depth=100,wv < 400) %>% summarise(
sum(irrad) -> below400
)
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad) -> below400
)
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad) -> below400nm
)
mced %>%
filter(depth==100) %>% summarise(
sum(irrad) -> allat100m
)
below400nm / allat100m
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad) -> below400nm
)
mced %>%
filter(depth==100) %>% summarise(
sum(irrad) -> allat100m
)
below400nm / allat100m
below400nm
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad)) -> below400nm
mced %>%
filter(depth==100) %>% summarise(
sum(irrad)) -> allat100m
below400nm / allat100m
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad)) -> below400nm
mced %>%
filter(depth==100) %>% summarise(
sum(irrad)) -> allat100m
print(paste('Percentage of photons below 400nm at 100 m depth:',
100 * below400nm / allat100m))
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad)) -> below400nm
mced %>%
filter(depth==100) %>% summarise(
sum(irrad)) -> allat100m
print(paste('Percentage of photons below 400nm at 100 m depth:',
round(100 * below400nm / allat100m)))
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad)) -> below400nm
mced %>%
filter(depth==100) %>% summarise(
sum(irrad)) -> allat100m
print(paste('Percentage of photons below 400nm at 100 m depth:',
round(100 * below400nm / allat100m,1),'%'))
mced %>%
filter(depth==100,wv < 400) %>% summarise(
sum(irrad)) -> below400nm
mced %>%
filter(depth==100) %>% summarise(
sum(irrad)) -> allat100m
print(paste0('Percentage of photons below 400nm at 100 m depth: ',
round(100 * below400nm / allat100m,1),'%'))
library('tidyverse')
wv <- seq(from=350,to=700,by=25)
tr <- c(.53,.66,.73,.76,.77,.78,.72,.58,.51,.38,.087,.041,.027,.012,.0015)
Ia <- paste0(signif(100*tr^10,2),'%')
df <- data.frame(wv=wv, Ia=Ia)
df
MC_Ed
MC_Ed$0
MC_Ed$´0´´
MC_Ed$´0´
MC_Ed %>%
mutate(light_left = `100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line()
MC_Ed %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line()
MC_Ed %>%
filter(wv > 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line()
MC_Ed %>%
filter(wv < 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line()
MC_Ed %>%
filter(wv < 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line() +
title('Percentage light remaining at 100 m depth')
MC_Ed %>%
filter(wv < 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line() +
ggtitle('Percentage light remaining at 100 m depth')
MC_Ed %>%
filter(wv >= 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line() +
ggtitle('Percentage light remaining at 100 m depth')
MC_Ed %>%
filter(wv <= 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line() +
ggtitle('Percentage light remaining at 100 m depth')
MC_Ed %>%
filter(wv <= 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line() +
ggtitle('Percentage light remaining at 100 m depth')
MC_Ed %>%
filter(wv <= 600) %>%
mutate(light_left = 100*`100` / `0`) %>%
ggplot(aes(y=light_left,x=wv)) + geom_line() +
ggtitle('Percentage light remaining at 100 m depth') + theme_classic()
mced %>% group_by(depth) %>%
summarise(umol = sum(irrad)) -> umol
umol
help("summarise")
mced %>% group_by(depth) %>%
summarise(umol = sum(irrad))-> umol
plot(umol,depth)
mced %>%
filter(wv >= 400) %>% group_by(depth) %>%
summarise(umol = sum(irrad))-> umol
plot(umol,depth)
umol
tail(umol)
mced %>% group_by(depth) %>%
summarise(umol = signif(sum(irrad)),4) -> umol
plot(umol,depth)
mced %>% group_by(depth) %>%
summarise(umol = signif(sum(irrad),4))) -> umol
mced %>% group_by(depth) %>%
summarise(umol = signif(sum(irrad),4)) -> umol
plot(umol,depth)
tail(umol)
mced %>% group_by(depth) %>%
summarise(umol = signif(sum(irrad),3)) -> umol
plot(umol,depth)
tail(umol)
